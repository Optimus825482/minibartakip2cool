{% extends "base.html" %} {% from "_form_helpers.html" import render_field,
render_submit, flash_messages %} {% block title %}Kat Y√∂netimi - Minibar Takip
Sistemi{% endblock %} {% block page_title %}Kat Y√∂netimi{% endblock %} {% block
content %}
<div class="space-y-6">
  <!-- Flash Messages -->
  {{ flash_messages() }}

  <!-- Yeni Kat Ekle Butonu -->
  <div class="bg-white dark:bg-slate-800 shadow rounded-lg">
    <div class="px-4 py-5 sm:p-6">
      <div class="flex items-center justify-between">
        <h3
          class="text-lg leading-6 font-medium text-slate-900 dark:text-slate-100"
        >
          Kat Y√∂netimi
        </h3>
        <div class="flex gap-3">
          <button
            onclick="odaTipleriYonetimModal()"
            class="inline-flex items-center px-4 py-2 border border-blue-600 dark:border-blue-500 shadow-sm text-sm font-medium rounded-md text-blue-700 dark:text-blue-300 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
          >
            <svg
              class="h-5 w-5 mr-2"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
              ></path>
            </svg>
            Oda Tipleri
          </button>
          <button
            onclick="yeniKatModal()"
            class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
          >
            <svg
              class="h-5 w-5 mr-2"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 4v16m8-8H4"
              ></path>
            </svg>
            Yeni Kat Ekle
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Mevcut Katlar Listesi -->
  <div class="bg-white dark:bg-slate-800 shadow rounded-lg">
    <div class="px-4 py-5 sm:p-6">
      <div class="flex items-center justify-between mb-4">
        <h3
          class="text-lg leading-6 font-medium text-slate-900 dark:text-slate-100"
        >
          Mevcut Katlar
        </h3>
        <div
          class="flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400"
        >
          <span
            class="font-medium"
            data-stats-for="katlar-table"
            data-stat="total"
            >{{ katlar|length }}</span
          >
          <span>Toplam Kat</span>
        </div>
      </div>

      {% if katlar %}
      <div class="table-wrapper">
        <table
          id="katlar-table"
          class="min-w-full divide-y divide-slate-200 dark:divide-slate-700"
        >
          <thead class="bg-slate-50 dark:bg-slate-900">
            <tr>
              <th
                class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"
              >
                Otel
              </th>
              <th
                class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"
              >
                Kat Adƒ±
              </th>
              <th
                class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"
              >
                Kat No
              </th>
              <th
                class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider hidden md:table-cell"
              >
                Oda Sayƒ±sƒ±
              </th>
              <th
                class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"
              >
                Durum
              </th>
              <th
                class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider no-sort"
              >
                ƒ∞≈ülemler
              </th>
            </tr>
          </thead>
          <tbody
            class="bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"
          >
            {% for kat in katlar %}
            <tr
              class="hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors"
            >
              <td
                class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-slate-500 dark:text-slate-400"
              >
                <span
                  class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200"
                >
                  üè® {{ kat.otel.ad if kat.otel else 'Otel Yok' }}
                </span>
              </td>
              <td
                class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm font-medium text-slate-900 dark:text-slate-100"
              >
                {{ kat.kat_adi }}
              </td>
              <td
                class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-slate-500 dark:text-slate-400"
              >
                <span
                  class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200"
                >
                  {% if kat.kat_no == 0 %}Zemin Kat{% else %}{{ kat.kat_no }}.
                  Kat{% endif %}
                </span>
              </td>
              <td
                class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-slate-500 dark:text-slate-400 hidden md:table-cell"
              >
                <span
                  class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"
                >
                  {{ kat.odalar|length }} oda
                </span>
              </td>
              <td class="px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap">
                <span
                  class="inline-flex px-2 py-1 text-xs font-semibold rounded-full {% if kat.aktif %}bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200{% else %}bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200{% endif %}"
                >
                  {% if kat.aktif %}Aktif{% else %}Pasif{% endif %}
                </span>
              </td>
              <td class="px-3 sm:px-6 py-3 sm:py-4 text-sm font-medium">
                <div class="flex flex-wrap gap-2">
                  <!-- Oda Tipleri Butonu - Bu kattaki odalarƒ±n oda tiplerini g√∂ster -->
                  <button
                    class="btn-kat-oda-tipleri inline-flex items-center px-3 py-1.5 border border-blue-300 dark:border-blue-600 rounded-md text-xs font-medium text-blue-700 dark:text-blue-300 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"
                    data-kat-id="{{ kat.id }}"
                    data-kat-adi="{{ kat.kat_adi }}"
                  >
                    <svg
                      class="h-3.5 w-3.5 mr-1"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"
                      ></path>
                    </svg>
                    Oda Tipleri
                  </button>

                  <button
                    type="button"
                    class="btn-kat-duzenle inline-flex items-center px-3 py-1.5 border border-slate-300 dark:border-slate-600 rounded-md text-xs font-medium text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"
                    data-kat-id="{{ kat.id }}"
                    data-otel-id="{{ kat.otel.id if kat.otel else 0 }}"
                    data-kat-adi="{{ kat.kat_adi }}"
                    data-kat-no="{{ kat.kat_no or 0 }}"
                    data-aciklama="{{ kat.aciklama or '' }}"
                  >
                    <svg
                      class="h-3.5 w-3.5 mr-1"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                      ></path>
                    </svg>
                    D√ºzenle
                  </button>

                  <!-- Sil Butonu -->
                  {% if kat.aktif %}
                  <form
                    method="POST"
                    action="{{ url_for('kat_sil', kat_id=kat.id) }}"
                    class="inline"
                  >
                    <input
                      type="hidden"
                      name="csrf_token"
                      value="{{ csrf_token() }}"
                    />
                    <button
                      type="submit"
                      class="inline-flex items-center px-3 py-1.5 border border-red-300 dark:border-red-600 rounded-md text-xs font-medium text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/40 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors"
                      onclick="return confirm('Bu katƒ± silmek istediƒüinizden emin misiniz?')"
                    >
                      <svg
                        class="h-3.5 w-3.5 mr-1"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                        ></path>
                      </svg>
                      Sil
                    </button>
                  </form>
                  {% endif %}
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <div class="text-center py-8">
        <svg
          class="mx-auto h-12 w-12 text-slate-400 dark:text-slate-600"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
          ></path>
        </svg>
        <h3 class="mt-2 text-sm font-medium text-slate-900 dark:text-slate-100">
          Hen√ºz kat eklenmemi≈ü
        </h3>
        <p class="mt-1 text-sm text-slate-500 dark:text-slate-400">
          Yukarƒ±daki formu kullanarak ilk katƒ±nƒ±zƒ± ekleyin.
        </p>
      </div>
      {% endif %}
    </div>
  </div>
</div>

<!-- Yeni Kat Ekle Modal -->
<div id="yeniKatModal" class="modal p-4 sm:p-6 md:p-8">
  <div
    class="bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full mx-auto"
  >
    <div
      class="px-6 py-4 border-b border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex items-center justify-between"
    >
      <h5
        class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center"
      >
        <svg
          class="h-5 w-5 mr-2 text-indigo-600 dark:text-indigo-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 4v16m8-8H4"
          ></path>
        </svg>
        Yeni Kat Ekle
      </h5>
      <a
        href="#"
        rel="modal:close"
        class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200"
      >
        <svg
          class="h-6 w-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </a>
    </div>
    <form method="POST" action="{{ url_for('kat_tanimla') }}">
      {{ form.csrf_token }}
      <div class="p-6">
        <div class="space-y-4">
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Otel <span class="text-red-500">*</span>
            </label>
            {{ form.otel_id(class="no-choices w-full px-3 py-2 border
            border-slate-300 dark:border-slate-600 rounded-md bg-slate-50
            dark:bg-slate-800 text-slate-900 dark:text-slate-100") }}
          </div>
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Kat Adƒ± <span class="text-red-500">*</span>
            </label>
            {{ form.kat_adi(class="w-full px-3 py-2 border border-slate-300
            dark:border-slate-600 rounded-md bg-white dark:bg-slate-700
            text-slate-900 dark:text-slate-100", placeholder="√ñrn: 1. Kat, Zemin
            Kat") }}
          </div>
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Kat No <span class="text-red-500">*</span>
            </label>
            {{ form.kat_no(class="w-full px-3 py-2 border border-slate-300
            dark:border-slate-600 rounded-md bg-white dark:bg-slate-700
            text-slate-900 dark:text-slate-100", placeholder="√ñrn: 0 (Zemin), 1,
            2, 3") }}
          </div>
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              A√ßƒ±klama
            </label>
            {{ form.aciklama(class="w-full px-3 py-2 border border-slate-300
            dark:border-slate-600 rounded-md bg-white dark:bg-slate-700
            text-slate-900 dark:text-slate-100", rows="3", placeholder="Kat
            hakkƒ±nda ek bilgiler...") }}
          </div>
          <div class="flex items-center">
            {{ form.aktif(class="h-4 w-4 text-indigo-600 focus:ring-indigo-500
            border-slate-300 dark:border-slate-600 rounded", checked="checked")
            }}
            <label
              class="ml-2 block text-sm text-slate-700 dark:text-slate-300"
            >
              Aktif
            </label>
          </div>
        </div>
      </div>
      <div
        class="px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex justify-end gap-3"
      >
        <a
          href="#"
          rel="modal:close"
          class="inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-600 shadow-sm text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700"
        >
          ƒ∞ptal
        </a>
        <button
          type="submit"
          class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700"
        >
          Kat Ekle
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Kat D√ºzenle Modal -->
<div id="katDuzenleModal" class="modal p-4 sm:p-6 md:p-8">
  <div
    class="bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full mx-auto"
  >
    <div
      class="px-6 py-4 border-b border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex items-center justify-between"
    >
      <h5
        class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center"
      >
        <svg
          class="h-5 w-5 mr-2 text-indigo-600 dark:text-indigo-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
          ></path>
        </svg>
        Kat D√ºzenle
      </h5>
      <a
        href="#"
        rel="modal:close"
        class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200"
      >
        <svg
          class="h-6 w-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </a>
    </div>
    <form id="katDuzenleForm" method="POST">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
      <div class="p-6">
        <div class="space-y-4">
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Otel <span class="text-red-500">*</span>
            </label>
            <select
              id="duzenle_otel_id"
              name="otel_id"
              class="no-choices w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100"
              required
            >
              {% for otel in form.otel_id.choices %}
              <option value="{{ otel[0] }}">{{ otel[1] }}</option>
              {% endfor %}
            </select>
          </div>
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Kat Adƒ± <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              id="duzenle_kat_adi"
              name="kat_adi"
              class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
              required
            />
          </div>
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Kat No <span class="text-red-500">*</span>
            </label>
            <input
              type="number"
              id="duzenle_kat_no"
              name="kat_no"
              class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
              required
            />
          </div>
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              A√ßƒ±klama
            </label>
            <textarea
              id="duzenle_aciklama"
              name="aciklama"
              rows="3"
              class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
            ></textarea>
          </div>
          <div class="flex items-center">
            <input
              type="checkbox"
              id="duzenle_aktif"
              name="aktif"
              class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 rounded"
              checked
            />
            <label
              for="duzenle_aktif"
              class="ml-2 block text-sm text-slate-700 dark:text-slate-300"
            >
              Aktif
            </label>
          </div>
        </div>
      </div>
      <div
        class="px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex justify-end gap-3"
      >
        <a
          href="#"
          rel="modal:close"
          class="inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-600 shadow-sm text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700"
        >
          ƒ∞ptal
        </a>
        <button
          type="submit"
          class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700"
        >
          G√ºncelle
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Oda Tipleri Y√∂netim Modal -->
<div id="odaTipleriYonetimModal" class="modal p-4 sm:p-6 md:p-8">
  <div
    class="bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-3xl w-full mx-auto"
  >
    <div
      class="px-6 py-4 border-b border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex items-center justify-between"
    >
      <h5
        class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center"
      >
        <svg
          class="h-5 w-5 mr-2 text-blue-600 dark:text-blue-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
          ></path>
        </svg>
        Oda Tipleri Y√∂netimi
      </h5>
      <a
        href="#"
        rel="modal:close"
        class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200"
      >
        <svg
          class="h-6 w-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </a>
    </div>
    <div class="p-6">
      <!-- Yeni Ekle Butonu -->
      <div class="flex justify-end mb-4">
        <button
          onclick="yeniOdaTipiModal()"
          class="inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"
        >
          <svg
            class="h-4 w-4 mr-1.5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 4v16m8-8H4"
            ></path>
          </svg>
          Yeni Ekle
        </button>
      </div>

      <!-- Y√ºkleniyor g√∂stergesi -->
      <div id="odaTipleriYonetimYukleniyor" class="text-center py-8">
        <div
          class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"
        ></div>
        <p class="mt-4 text-slate-600 dark:text-slate-400">
          Oda tipleri y√ºkleniyor...
        </p>
      </div>

      <!-- ƒ∞√ßerik -->
      <div id="odaTipleriYonetimIcerik" style="display: none">
        <!-- Tablo -->
        <div class="overflow-x-auto">
          <table
            class="min-w-full divide-y divide-slate-200 dark:divide-slate-700"
          >
            <thead class="bg-slate-50 dark:bg-slate-900">
              <tr>
                <th
                  class="px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"
                >
                  Oda Tipi Adƒ±
                </th>
                <th
                  class="px-4 py-3 text-center text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"
                >
                  Dolap Sayƒ±sƒ±
                </th>
                <th
                  class="px-4 py-3 text-center text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"
                >
                  Setup
                </th>
                <th
                  class="px-4 py-3 text-right text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"
                >
                  ƒ∞≈ülemler
                </th>
              </tr>
            </thead>
            <tbody
              id="odaTipleriYonetimTablo"
              class="bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"
            >
              <!-- JavaScript ile doldurulacak -->
            </tbody>
          </table>
        </div>

        <!-- Oda tipi yok mesajƒ± -->
        <div
          id="odaTipleriYonetimYokMesaji"
          style="display: none"
          class="text-center py-8"
        >
          <svg
            class="mx-auto h-12 w-12 text-slate-400 dark:text-slate-600"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"
            ></path>
          </svg>
          <p class="mt-4 text-slate-600 dark:text-slate-400 font-medium">
            Hen√ºz oda tipi eklenmemi≈ü
          </p>
          <p class="mt-2 text-sm text-slate-500 dark:text-slate-500">
            Yukarƒ±daki "Yeni Ekle" butonunu kullanarak oda tipi ekleyebilirsiniz
          </p>
        </div>
      </div>
    </div>
    <div
      class="px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex justify-end"
    >
      <a
        href="#"
        rel="modal:close"
        class="inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-600 shadow-sm text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700"
      >
        Kapat
      </a>
    </div>
  </div>
</div>

<!-- Kat Oda Tipleri Modal - Bu kattaki odalarƒ±n oda tiplerini g√∂ster -->
<div id="katOdaTipleriModal" class="modal p-4 sm:p-6 md:p-8">
  <div
    class="bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-3xl w-full mx-auto"
  >
    <div
      class="px-6 py-4 border-b border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex items-center justify-between"
    >
      <h5
        class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center"
      >
        <svg
          class="h-5 w-5 mr-2 text-blue-600 dark:text-blue-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
          ></path>
        </svg>
        <span id="katOdaTipleriBaslik"></span> - Oda Tipleri
      </h5>
      <a
        href="#"
        rel="modal:close"
        class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200"
      >
        <svg
          class="h-6 w-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </a>
    </div>
    <div class="p-6">
      <!-- Y√ºkleniyor g√∂stergesi -->
      <div id="katOdaTipleriYukleniyor" class="text-center py-8">
        <div
          class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"
        ></div>
        <p class="mt-4 text-slate-600 dark:text-slate-400">
          Oda tipleri y√ºkleniyor...
        </p>
      </div>

      <!-- ƒ∞√ßerik -->
      <div id="katOdaTipleriIcerik" style="display: none">
        <!-- √ñzet Bilgi -->
        <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-4">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm text-slate-600 dark:text-slate-400">
                Toplam Oda Sayƒ±sƒ±
              </p>
              <p
                id="katToplamOda"
                class="text-2xl font-bold text-blue-600 dark:text-blue-400"
              >
                0
              </p>
            </div>
            <div>
              <p class="text-sm text-slate-600 dark:text-slate-400">
                Farklƒ± Oda Tipi
              </p>
              <p
                id="katFarkliTip"
                class="text-2xl font-bold text-indigo-600 dark:text-indigo-400"
              >
                0
              </p>
            </div>
          </div>
        </div>

        <!-- Oda Tipi Listesi -->
        <div class="space-y-3" id="katOdaTipleriListe">
          <!-- JavaScript ile doldurulacak -->
        </div>
      </div>

      <!-- Oda yok mesajƒ± -->
      <div
        id="katOdaTipleriYokMesaji"
        style="display: none"
        class="text-center py-8"
      >
        <svg
          class="mx-auto h-12 w-12 text-slate-400 dark:text-slate-600"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"
          ></path>
        </svg>
        <p class="mt-4 text-slate-600 dark:text-slate-400 font-medium">
          Bu katta hen√ºz oda bulunmuyor
        </p>
      </div>
    </div>
    <div
      class="px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex justify-end"
    >
      <a
        href="#"
        rel="modal:close"
        class="inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-600 shadow-sm text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700"
      >
        Kapat
      </a>
    </div>
  </div>
</div>

<!-- Yeni Oda Tipi Ekle Modal -->
<div id="yeniOdaTipiModal" class="modal p-4 sm:p-6 md:p-8">
  <div
    class="bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full mx-auto"
  >
    <div
      class="px-6 py-4 border-b border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex items-center justify-between"
    >
      <h5
        class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center"
      >
        <svg
          class="h-5 w-5 mr-2 text-green-600 dark:text-green-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 4v16m8-8H4"
          ></path>
        </svg>
        Yeni Oda Tipi
      </h5>
      <a
        href="#"
        rel="modal:close"
        class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200"
      >
        <svg
          class="h-6 w-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </a>
    </div>
    <form id="yeniOdaTipiForm" onsubmit="odaTipiKaydet(event)">
      <div class="p-6">
        <div class="space-y-4">
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Oda Tipi Adƒ± <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              id="yeni_oda_tipi_ad"
              name="ad"
              class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
              placeholder="√ñrn: STANDARD, JUNIOR SUITE"
              required
            />
          </div>
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Dolap Sayƒ±sƒ± <span class="text-red-500">*</span>
            </label>
            <input
              type="number"
              id="yeni_oda_tipi_dolap"
              name="dolap_sayisi"
              min="0"
              class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
              placeholder="√ñrn: 1, 2"
              required
            />
          </div>
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Setup'lar <span class="text-red-500">*</span>
            </label>
            <select
              id="yeni_oda_tipi_setup"
              name="setup_ids"
              multiple
              class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
              style="min-height: 100px"
              required
            >
              <!-- JavaScript ile doldurulacak -->
            </select>
            <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">
              Ctrl/Cmd tu≈üu ile birden fazla setup se√ßebilirsiniz
            </p>
          </div>
        </div>
      </div>
      <div
        class="px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex justify-end gap-3"
      >
        <a
          href="#"
          rel="modal:close"
          class="inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-600 shadow-sm text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700"
        >
          ƒ∞ptal
        </a>
        <button
          type="submit"
          class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700"
        >
          Kaydet
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Oda Tipi D√ºzenle Modal -->
<div id="odaTipiDuzenleModal" class="modal p-4 sm:p-6 md:p-8">
  <div
    class="bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full mx-auto"
  >
    <div
      class="px-6 py-4 border-b border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex items-center justify-between"
    >
      <h5
        class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center"
      >
        <svg
          class="h-5 w-5 mr-2 text-indigo-600 dark:text-indigo-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
          ></path>
        </svg>
        Oda Tipi D√ºzenle
      </h5>
      <a
        href="#"
        rel="modal:close"
        class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200"
      >
        <svg
          class="h-6 w-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </a>
    </div>
    <form id="odaTipiDuzenleForm" onsubmit="odaTipiGuncelle(event)">
      <input type="hidden" id="duzenle_oda_tipi_id" name="id" />
      <div class="p-6">
        <div class="space-y-4">
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Oda Tipi Adƒ± <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              id="duzenle_oda_tipi_ad"
              name="ad"
              class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
              required
            />
          </div>
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Dolap Sayƒ±sƒ± <span class="text-red-500">*</span>
            </label>
            <input
              type="number"
              id="duzenle_oda_tipi_dolap"
              name="dolap_sayisi"
              min="0"
              class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
              required
            />
          </div>
          <div>
            <label
              class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"
            >
              Setup'lar <span class="text-red-500">*</span>
            </label>
            <select
              id="duzenle_oda_tipi_setup"
              name="setup_ids"
              multiple
              class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
              style="min-height: 100px"
              required
            >
              <!-- JavaScript ile doldurulacak -->
            </select>
            <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">
              Ctrl/Cmd tu≈üu ile birden fazla setup se√ßebilirsiniz
            </p>
          </div>
        </div>
      </div>
      <div
        class="px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex justify-end gap-3"
      >
        <a
          href="#"
          rel="modal:close"
          class="inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-600 shadow-sm text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700"
        >
          ƒ∞ptal
        </a>
        <button
          type="submit"
          class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700"
        >
          G√ºncelle
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Oda Tipleri Modal -->
<div id="odaTipleriModal" class="modal p-4 sm:p-6 md:p-8">
  <div
    class="bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-3xl w-full mx-auto"
  >
    <div
      class="px-6 py-4 border-b border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex items-center justify-between"
    >
      <h5
        class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center"
      >
        <svg
          class="h-5 w-5 mr-2 text-blue-600 dark:text-blue-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"
          ></path>
        </svg>
        <span id="odaTipleriBaslik">Oda Tipleri Daƒüƒ±lƒ±mƒ±</span>
      </h5>
      <a
        href="#"
        rel="modal:close"
        class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-200"
      >
        <svg
          class="h-6 w-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </a>
    </div>
    <div class="p-6">
      <!-- Y√ºkleniyor g√∂stergesi -->
      <div id="odaTipleriYukleniyor" class="text-center py-8">
        <div
          class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"
        ></div>
        <p class="mt-4 text-slate-600 dark:text-slate-400">
          Oda tipleri y√ºkleniyor...
        </p>
      </div>

      <!-- ƒ∞√ßerik -->
      <div id="odaTipleriIcerik" style="display: none">
        <!-- √ñzet Bilgi -->
        <div
          class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-6"
        >
          <div class="flex items-start">
            <svg
              class="h-5 w-5 text-blue-600 dark:text-blue-400 mr-2 mt-0.5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
              ></path>
            </svg>
            <div class="flex-1">
              <p class="text-sm font-medium text-blue-800 dark:text-blue-200">
                <span id="odaTipleriOtelAdi"></span> -
                <span id="odaTipleriKatAdi"></span>
              </p>
              <p class="text-sm text-blue-700 dark:text-blue-300 mt-1">
                Toplam
                <span id="odaTipleriToplamOda" class="font-semibold">0</span>
                oda
              </p>
            </div>
          </div>
        </div>

        <!-- Tablo -->
        <div class="overflow-x-auto">
          <table
            class="min-w-full divide-y divide-slate-200 dark:divide-slate-700"
          >
            <thead class="bg-slate-50 dark:bg-slate-900">
              <tr>
                <th
                  class="px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"
                >
                  Oda Tipi
                </th>
                <th
                  class="px-4 py-3 text-center text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"
                >
                  Oda Sayƒ±sƒ±
                </th>
                <th
                  class="px-4 py-3 text-center text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"
                >
                  Y√ºzde
                </th>
              </tr>
            </thead>
            <tbody
              id="odaTipleriTablo"
              class="bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"
            >
              <!-- JavaScript ile doldurulacak -->
            </tbody>
          </table>
        </div>

        <!-- Oda tipi yok mesajƒ± -->
        <div
          id="odaTipleriYokMesaji"
          style="display: none"
          class="text-center py-8"
        >
          <svg
            class="mx-auto h-12 w-12 text-slate-400 dark:text-slate-600"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"
            ></path>
          </svg>
          <p class="mt-4 text-slate-600 dark:text-slate-400 font-medium">
            Bu katta hen√ºz oda bulunmuyor
          </p>
          <p class="mt-2 text-sm text-slate-500 dark:text-slate-500">
            Oda Tanƒ±mla sayfasƒ±ndan oda ekleyebilirsiniz
          </p>
        </div>
      </div>
    </div>
    <div
      class="px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex justify-end"
    >
      <a
        href="#"
        rel="modal:close"
        class="inline-flex items-center px-4 py-2 border border-slate-300 dark:border-slate-600 shadow-sm text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700"
      >
        Kapat
      </a>
    </div>
  </div>
</div>

{% endblock %} {% block extra_scripts %}
<script>
  // Modal a√ßma fonksiyonlarƒ±
  function yeniKatModal() {
    $("#yeniKatModal").modal({
      fadeDuration: 200,
      fadeDelay: 0.1,
    });
  }

  function katDuzenleModal(katId, otelId, katAdi, katNo, aciklama) {
    document.getElementById("duzenle_otel_id").value = otelId;
    document.getElementById("duzenle_kat_adi").value = katAdi;
    document.getElementById("duzenle_kat_no").value = katNo;
    document.getElementById("duzenle_aciklama").value = aciklama || "";

    // Form action'ƒ± g√ºncelle
    document.getElementById("katDuzenleForm").action = `/kat-duzenle/${katId}`;

    $("#katDuzenleModal").modal({
      fadeDuration: 200,
      fadeDelay: 0.1,
    });
  }

  // Oda tipleri modal
  function odaTipleriModal(katId, katAdi, otelAdi) {
    // Modal ba≈ülƒ±ƒüƒ±nƒ± g√ºncelle
    document.getElementById(
      "odaTipleriBaslik"
    ).textContent = `${otelAdi} - ${katAdi} Oda Tipleri`;
    document.getElementById("odaTipleriOtelAdi").textContent = otelAdi;
    document.getElementById("odaTipleriKatAdi").textContent = katAdi;

    // Y√ºkleniyor g√∂ster
    document.getElementById("odaTipleriYukleniyor").style.display = "block";
    document.getElementById("odaTipleriIcerik").style.display = "none";

    // Modal'ƒ± a√ß
    $("#odaTipleriModal").modal({
      fadeDuration: 200,
      fadeDelay: 0.1,
    });

    // AJAX ile oda tiplerini getir
    fetch(`/api/katlar/${katId}/oda-tipleri`)
      .then((response) => response.json())
      .then((data) => {
        // Y√ºkleniyor gizle, i√ßerik g√∂ster
        document.getElementById("odaTipleriYukleniyor").style.display = "none";
        document.getElementById("odaTipleriIcerik").style.display = "block";

        if (data.success && data.oda_tipleri && data.oda_tipleri.length > 0) {
          // Toplam oda sayƒ±sƒ±
          const toplamOda = data.oda_tipleri.reduce(
            (sum, tip) => sum + tip.sayi,
            0
          );
          document.getElementById("odaTipleriToplamOda").textContent =
            toplamOda;

          // Tablo doldur
          const tbody = document.getElementById("odaTipleriTablo");
          tbody.innerHTML = "";

          // Oda tipi renkleri
          const odaTipiRenkler = {
            Standart:
              "bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200",
            Deluxe:
              "bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200",
            Suite:
              "bg-amber-100 dark:bg-amber-900 text-amber-800 dark:text-amber-200",
            King: "bg-rose-100 dark:bg-rose-900 text-rose-800 dark:text-rose-200",
            Twin: "bg-cyan-100 dark:bg-cyan-900 text-cyan-800 dark:text-cyan-200",
            Family:
              "bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200",
            Executive:
              "bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200",
            Presidential:
              "bg-pink-100 dark:bg-pink-900 text-pink-800 dark:text-pink-200",
          };

          data.oda_tipleri.forEach((tip) => {
            const yuzde = ((tip.sayi / toplamOda) * 100).toFixed(1);
            const renkClass =
              odaTipiRenkler[tip.oda_tipi] ||
              "bg-slate-100 dark:bg-slate-800 text-slate-800 dark:text-slate-200";

            const row = document.createElement("tr");
            row.className =
              "hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors";
            row.innerHTML = `
                            <td class="px-4 py-3 whitespace-nowrap">
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${renkClass}">
                                    ${tip.oda_tipi || "Belirtilmemi≈ü"}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-center">
                                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-slate-200">
                                    ${tip.sayi}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-center">
                                <div class="flex items-center justify-center gap-2">
                                    <div class="flex-1 max-w-xs bg-slate-200 dark:bg-slate-700 rounded-full h-2">
                                        <div class="bg-blue-600 dark:bg-blue-500 h-2 rounded-full transition-all" style="width: ${yuzde}%"></div>
                                    </div>
                                    <span class="text-sm font-medium text-slate-700 dark:text-slate-300 min-w-[3rem]">
                                        %${yuzde}
                                    </span>
                                </div>
                            </td>
                        `;
            tbody.appendChild(row);
          });

          document.getElementById("odaTipleriYokMesaji").style.display = "none";
        } else {
          // Oda yok mesajƒ± g√∂ster
          document.getElementById("odaTipleriToplamOda").textContent = "0";
          document.getElementById("odaTipleriYokMesaji").style.display =
            "block";
          document.querySelector(
            "#odaTipleriIcerik .overflow-x-auto"
          ).style.display = "none";
        }
      })
      .catch((error) => {
        console.error("Hata:", error);
        document.getElementById("odaTipleriYukleniyor").style.display = "none";
        document.getElementById("odaTipleriIcerik").style.display = "block";
        document.getElementById("odaTipleriYokMesaji").style.display = "block";
        document.querySelector(
          "#odaTipleriIcerik .overflow-x-auto"
        ).style.display = "none";
      });
  }

  // ============================================================================
  // ODA Tƒ∞Pƒ∞ Y√ñNETƒ∞Mƒ∞ FONKSƒ∞YONLARI
  // ============================================================================

  // Oda tipleri y√∂netim modal
  function odaTipleriYonetimModal() {
    // Y√ºkleniyor g√∂ster
    document.getElementById("odaTipleriYonetimYukleniyor").style.display =
      "block";
    document.getElementById("odaTipleriYonetimIcerik").style.display = "none";

    // Modal'ƒ± a√ß
    $("#odaTipleriYonetimModal").modal({
      fadeDuration: 200,
      fadeDelay: 0.1,
    });

    // Oda tiplerini y√ºkle
    odaTipleriYukle();
  }

  // Oda tiplerini y√ºkle
  function odaTipleriYukle() {
    fetch("/api/oda-tipleri")
      .then((response) => response.json())
      .then((data) => {
        // Y√ºkleniyor gizle, i√ßerik g√∂ster
        document.getElementById("odaTipleriYonetimYukleniyor").style.display =
          "none";
        document.getElementById("odaTipleriYonetimIcerik").style.display =
          "block";

        if (data.success && data.oda_tipleri && data.oda_tipleri.length > 0) {
          // Tablo doldur
          const tbody = document.getElementById("odaTipleriYonetimTablo");
          tbody.innerHTML = "";

          data.oda_tipleri.forEach((tip) => {
            // Setup'larƒ± g√∂ster - birden fazla olabilir
            let setupHTML = "";
            if (tip.setup_adlari && tip.setup_adlari.length > 0) {
              setupHTML = tip.setup_adlari
                .map((setupAd) => {
                  const setupRenk =
                    setupAd === "MAXI"
                      ? "bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200"
                      : "bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200";
                  return `<span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${setupRenk} mr-1 mb-1">${setupAd}</span>`;
                })
                .join("");
            } else {
              setupHTML =
                '<span class="text-slate-400 dark:text-slate-500 text-sm">-</span>';
            }

            const row = document.createElement("tr");
            row.className =
              "hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors";
            row.innerHTML = `
                            <td class="px-4 py-3 whitespace-nowrap">
                                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200">
                                    ${tip.ad}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-center">
                                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-slate-200">
                                    ${tip.dolap_sayisi || 0}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-center">
                                <div class="flex flex-wrap justify-center gap-1">
                                    ${setupHTML}
                                </div>
                            </td>
                            <td class="px-4 py-3 text-right">
                                <div class="flex justify-end gap-2">
                                    <button data-action="edit" data-id="${
                                      tip.id
                                    }" data-ad="${tip.ad}" data-dolap="${
              tip.dolap_sayisi || 0
            }" data-setup-ids="${(tip.setup_ids || []).join(",")}"
                                            class="btn-oda-tipi-duzenle inline-flex items-center px-3 py-1.5 border border-slate-300 dark:border-slate-600 rounded-md text-xs font-medium text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600">
                                        <svg class="h-3.5 w-3.5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                        </svg>
                                        D√ºzenle
                                    </button>
                                    <button data-action="delete" data-id="${
                                      tip.id
                                    }" data-ad="${tip.ad}"
                                            class="btn-oda-tipi-sil inline-flex items-center px-3 py-1.5 border border-red-300 dark:border-red-600 rounded-md text-xs font-medium text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/40">
                                        <svg class="h-3.5 w-3.5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                        </svg>
                                        Sil
                                    </button>
                                </div>
                            </td>
                        `;
            tbody.appendChild(row);
          });

          document.getElementById("odaTipleriYonetimYokMesaji").style.display =
            "none";
          document.querySelector(
            "#odaTipleriYonetimIcerik .overflow-x-auto"
          ).style.display = "block";

          // Event delegation ile buton click'lerini dinle
          document.querySelectorAll(".btn-oda-tipi-duzenle").forEach((btn) => {
            btn.addEventListener("click", function () {
              const id = this.dataset.id;
              const ad = this.dataset.ad;
              const dolap = this.dataset.dolap;
              const setupIds = this.dataset.setupIds; // Artƒ±k setup_ids kullanƒ±yoruz
              odaTipiDuzenleModal(id, ad, dolap, setupIds);
            });
          });

          document.querySelectorAll(".btn-oda-tipi-sil").forEach((btn) => {
            btn.addEventListener("click", function () {
              const id = this.dataset.id;
              const ad = this.dataset.ad;
              odaTipiSil(id, ad);
            });
          });
        } else {
          // Oda tipi yok mesajƒ± g√∂ster
          document.getElementById("odaTipleriYonetimYokMesaji").style.display =
            "block";
          document.querySelector(
            "#odaTipleriYonetimIcerik .overflow-x-auto"
          ).style.display = "none";
        }
      })
      .catch((error) => {
        console.error("Hata:", error);
        document.getElementById("odaTipleriYonetimYukleniyor").style.display =
          "none";
        document.getElementById("odaTipleriYonetimIcerik").style.display =
          "block";
        document.getElementById("odaTipleriYonetimYokMesaji").style.display =
          "block";
        document.querySelector(
          "#odaTipleriYonetimIcerik .overflow-x-auto"
        ).style.display = "none";
      });
  }

  // Yeni oda tipi modal
  function yeniOdaTipiModal() {
    document.getElementById("yeni_oda_tipi_ad").value = "";
    document.getElementById("yeni_oda_tipi_dolap").value = "";

    // Setup listesini API'den √ßek
    const setupSelect = document.getElementById("yeni_oda_tipi_setup");
    setupSelect.innerHTML = '<option value="">Y√ºkleniyor...</option>';

    fetch("/api/setuplar")
      .then((response) => response.json())
      .then((data) => {
        if (data.success && data.setuplar) {
          setupSelect.innerHTML = "";
          data.setuplar.forEach((setup) => {
            const option = document.createElement("option");
            option.value = setup.id;
            option.textContent = setup.ad;
            setupSelect.appendChild(option);
          });
        } else {
          setupSelect.innerHTML = '<option value="">Setup bulunamadƒ±</option>';
        }
      })
      .catch((error) => {
        console.error("Setup listesi y√ºklenemedi:", error);
        setupSelect.innerHTML = '<option value="">Hata olu≈ütu</option>';
      });

    $("#yeniOdaTipiModal").modal({
      fadeDuration: 200,
      fadeDelay: 0.1,
    });
  }

  // Oda tipi kaydet
  function odaTipiKaydet(event) {
    event.preventDefault();

    const ad = document.getElementById("yeni_oda_tipi_ad").value.trim();
    const dolap_sayisi = parseInt(
      document.getElementById("yeni_oda_tipi_dolap").value
    );

    // √áoklu se√ßim - se√ßili setup ID'lerini al
    const setupSelect = document.getElementById("yeni_oda_tipi_setup");
    const setup_ids = Array.from(setupSelect.selectedOptions).map((opt) =>
      parseInt(opt.value)
    );

    if (!ad) {
      alert("Oda tipi adƒ± bo≈ü olamaz");
      return;
    }

    if (setup_ids.length === 0) {
      alert("En az bir setup se√ßimi zorunludur");
      return;
    }

    fetch("/api/oda-tipleri", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        ad: ad,
        dolap_sayisi: dolap_sayisi,
        setup_ids: setup_ids,
      }),
    })
      .then((response) => response.json())
      .then((data) => {
        if (data.success) {
          yeniOdaTipiModalKapat();
          odaTipleriYukle();

          // Ba≈üarƒ± mesajƒ±
          const alertDiv = document.createElement("div");
          alertDiv.className =
            "alert alert-success alert-dismissible fade show";
          alertDiv.innerHTML = `
                    <strong>Ba≈üarƒ±lƒ±!</strong> Oda tipi ba≈üarƒ±yla eklendi.
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                `;
          document
            .querySelector(".space-y-6")
            .insertBefore(
              alertDiv,
              document.querySelector(".space-y-6").firstChild
            );

          setTimeout(() => alertDiv.remove(), 3000);
        } else {
          alert("Hata: " + data.error);
        }
      })
      .catch((error) => {
        console.error("Hata:", error);
        alert("Oda tipi eklenirken hata olu≈ütu");
      });
  }

  // Oda tipi d√ºzenle modal
  function odaTipiDuzenleModal(id, ad, dolap_sayisi, setup_ids_str) {
    document.getElementById("duzenle_oda_tipi_id").value = id;
    document.getElementById("duzenle_oda_tipi_ad").value = ad;
    document.getElementById("duzenle_oda_tipi_dolap").value = dolap_sayisi || 0;

    // Setup listesini API'den √ßek ve se√ßili olanlarƒ± i≈üaretle
    const setupSelect = document.getElementById("duzenle_oda_tipi_setup");
    setupSelect.innerHTML = '<option value="">Y√ºkleniyor...</option>';

    const secilenSetupIds = setup_ids_str
      ? setup_ids_str.split(",").map((id) => parseInt(id))
      : [];

    fetch("/api/setuplar")
      .then((response) => response.json())
      .then((data) => {
        if (data.success && data.setuplar) {
          setupSelect.innerHTML = "";
          data.setuplar.forEach((setup) => {
            const option = document.createElement("option");
            option.value = setup.id;
            option.textContent = setup.ad;
            // Se√ßili setup'larƒ± i≈üaretle
            if (secilenSetupIds.includes(setup.id)) {
              option.selected = true;
            }
            setupSelect.appendChild(option);
          });
        } else {
          setupSelect.innerHTML = '<option value="">Setup bulunamadƒ±</option>';
        }
      })
      .catch((error) => {
        console.error("Setup listesi y√ºklenemedi:", error);
        setupSelect.innerHTML = '<option value="">Hata olu≈ütu</option>';
      });

    $("#odaTipiDuzenleModal").modal({
      fadeDuration: 200,
      fadeDelay: 0.1,
    });
  }

  // Oda tipi g√ºncelle
  function odaTipiGuncelle(event) {
    event.preventDefault();

    const id = document.getElementById("duzenle_oda_tipi_id").value;
    const ad = document.getElementById("duzenle_oda_tipi_ad").value.trim();
    const dolap_sayisi = parseInt(
      document.getElementById("duzenle_oda_tipi_dolap").value
    );

    // √áoklu se√ßim - se√ßili setup ID'lerini al
    const setupSelect = document.getElementById("duzenle_oda_tipi_setup");
    const setup_ids = Array.from(setupSelect.selectedOptions).map((opt) =>
      parseInt(opt.value)
    );

    if (!ad) {
      alert("Oda tipi adƒ± bo≈ü olamaz");
      return;
    }

    if (setup_ids.length === 0) {
      alert("En az bir setup se√ßimi zorunludur");
      return;
    }

    fetch(`/api/oda-tipleri/${id}`, {
      method: "PUT",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        ad: ad,
        dolap_sayisi: dolap_sayisi,
        setup_ids: setup_ids,
      }),
    })
      .then((response) => response.json())
      .then((data) => {
        if (data.success) {
          odaTipiDuzenleModalKapat();
          odaTipleriYukle();

          // Ba≈üarƒ± mesajƒ±
          const alertDiv = document.createElement("div");
          alertDiv.className =
            "alert alert-success alert-dismissible fade show";
          alertDiv.innerHTML = `
                    <strong>Ba≈üarƒ±lƒ±!</strong> Oda tipi ba≈üarƒ±yla g√ºncellendi.
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                `;
          document
            .querySelector(".space-y-6")
            .insertBefore(
              alertDiv,
              document.querySelector(".space-y-6").firstChild
            );

          setTimeout(() => alertDiv.remove(), 3000);
        } else {
          alert("Hata: " + data.error);
        }
      })
      .catch((error) => {
        console.error("Hata:", error);
        alert("Oda tipi g√ºncellenirken hata olu≈ütu");
      });
  }

  // Oda tipi sil
  function odaTipiSil(id, ad) {
    if (!confirm(`"${ad}" oda tipini silmek istediƒüinizden emin misiniz?`)) {
      return;
    }

    fetch(`/api/oda-tipleri/${id}`, {
      method: "DELETE",
    })
      .then((response) => response.json())
      .then((data) => {
        if (data.success) {
          odaTipleriYukle();

          // Ba≈üarƒ± mesajƒ±
          const alertDiv = document.createElement("div");
          alertDiv.className =
            "alert alert-success alert-dismissible fade show";
          alertDiv.innerHTML = `
                    <strong>Ba≈üarƒ±lƒ±!</strong> Oda tipi ba≈üarƒ±yla silindi.
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                `;
          document
            .querySelector(".space-y-6")
            .insertBefore(
              alertDiv,
              document.querySelector(".space-y-6").firstChild
            );

          setTimeout(() => alertDiv.remove(), 3000);
        } else {
          alert("Hata: " + data.error);
        }
      })
      .catch((error) => {
        console.error("Hata:", error);
        alert("Oda tipi silinirken hata olu≈ütu");
      });
  }

  // ============================================================================

  // Tablo filtreleme
  document.addEventListener("DOMContentLoaded", function () {
    const katlarTable = document.getElementById("katlar-table");
    if (katlarTable) {
      new TableSearchFilter("katlar-table", {
        searchPlaceholder: "Kat adƒ±, kat no veya oda sayƒ±sƒ± ile ara...",
        filters: [
          {
            columnIndex: 3, // Durum s√ºtunu
            label: "Durum",
            options: [
              { value: "Aktif", label: "Aktif" },
              { value: "Pasif", label: "Pasif" },
            ],
          },
        ],
        defaultItemsPerPage: 25,
      });
    }

    // Kat d√ºzenle butonlarƒ± i√ßin event listener
    document.querySelectorAll(".btn-kat-duzenle").forEach((btn) => {
      btn.addEventListener("click", function () {
        const katId = this.dataset.katId;
        const otelId = this.dataset.otelId;
        const katAdi = this.dataset.katAdi;
        const katNo = this.dataset.katNo;
        const aciklama = this.dataset.aciklama;
        katDuzenleModal(katId, otelId, katAdi, katNo, aciklama);
      });
    });

    // Kat oda tipleri butonlarƒ± i√ßin event listener
    document.querySelectorAll(".btn-kat-oda-tipleri").forEach((btn) => {
      btn.addEventListener("click", function () {
        const katId = this.dataset.katId;
        const katAdi = this.dataset.katAdi;
        katOdaTipleriModal(katId, katAdi);
      });
    });
  });

  // Kat Oda Tipleri Modal - Bu kattaki odalarƒ±n oda tiplerini g√∂ster
  function katOdaTipleriModal(katId, katAdi) {
    console.log("Kat oda tipleri modal a√ßƒ±lƒ±yor:", katId, katAdi);

    // Ba≈ülƒ±ƒüƒ± ayarla
    document.getElementById("katOdaTipleriBaslik").textContent = katAdi;

    // Y√ºkleniyor g√∂ster
    document.getElementById("katOdaTipleriYukleniyor").style.display = "block";
    document.getElementById("katOdaTipleriIcerik").style.display = "none";
    document.getElementById("katOdaTipleriYokMesaji").style.display = "none";

    // Modal'ƒ± a√ß
    $("#katOdaTipleriModal").modal({
      fadeDuration: 200,
      fadeDelay: 0.1,
    });

    // Bu kattaki odalarƒ± getir
    fetch(`/api/katlar/${katId}/odalar`)
      .then((response) => response.json())
      .then((data) => {
        document.getElementById("katOdaTipleriYukleniyor").style.display =
          "none";

        if (data.success && data.odalar && data.odalar.length > 0) {
          // Oda tiplerini grupla
          const odaTipleri = {};
          data.odalar.forEach((oda) => {
            const tip = oda.oda_tipi || "Belirtilmemi≈ü";
            if (!odaTipleri[tip]) {
              odaTipleri[tip] = [];
            }
            odaTipleri[tip].push(oda.oda_no);
          });

          // √ñzet bilgileri g√∂ster
          document.getElementById("katToplamOda").textContent =
            data.odalar.length;
          document.getElementById("katFarkliTip").textContent =
            Object.keys(odaTipleri).length;

          // Liste olu≈ütur
          const liste = document.getElementById("katOdaTipleriListe");
          liste.innerHTML = "";

          Object.keys(odaTipleri)
            .sort()
            .forEach((tip) => {
              const odalar = odaTipleri[tip].sort((a, b) => {
                // Sayƒ±sal sƒ±ralama
                const numA = parseInt(a) || 0;
                const numB = parseInt(b) || 0;
                return numA - numB;
              });

              const card = document.createElement("div");
              card.className =
                "bg-slate-50 dark:bg-slate-900 rounded-lg p-4 border border-slate-200 dark:border-slate-700";
              card.innerHTML = `
                <div class="flex items-center justify-between mb-3">
                  <h6 class="text-sm font-semibold text-slate-900 dark:text-slate-100">
                    <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200">
                      ${tip}
                    </span>
                  </h6>
                  <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200">
                    ${odalar.length} oda
                  </span>
                </div>
                <div class="flex flex-wrap gap-2">
                  ${odalar
                    .map(
                      (odaNo) => `
                    <span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-300 border border-slate-300 dark:border-slate-600">
                      ${odaNo}
                    </span>
                  `
                    )
                    .join("")}
                </div>
              `;
              liste.appendChild(card);
            });

          document.getElementById("katOdaTipleriIcerik").style.display =
            "block";
        } else {
          // Oda yok
          document.getElementById("katOdaTipleriYokMesaji").style.display =
            "block";
        }
      })
      .catch((error) => {
        console.error("Hata:", error);
        document.getElementById("katOdaTipleriYukleniyor").style.display =
          "none";
        document.getElementById("katOdaTipleriYokMesaji").style.display =
          "block";
      });
  }
</script>
{% endblock %}
