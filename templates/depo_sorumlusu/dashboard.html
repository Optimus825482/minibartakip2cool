{% extends "base.html" %} {% block title %}Depo Sorumlusu Panel - Minibar Takip
Sistemi{% endblock %} {% block page_title %}Panel{% endblock %} {% block
page_icon_bg %}bg-gradient-to-br from-slate-500 to-slate-700{% endblock %} {%
block page_icon %}fas fa-th-large{% endblock %} {% block content %}
<div class="space-y-6">
  <!-- G√ºnl√ºk G√∂revlerim Widget - Depo Sorumlusu -->
  {% set yukleme = yukleme_gorev_ozeti or {'toplam': 0, 'tamamlanan': 0,
  'bekleyen': 0, 'tamamlanma_orani': 0, 'inhouse_durum': 'pending',
  'arrivals_durum': 'pending', 'departures_durum': 'pending'} %} {% if
  yukleme.tamamlanma_orani == 100 and oda_kontrol_ozeti %}
  <!-- Kat Sorumlusu G√∂revleri ƒ∞lerleme Widget (Y√ºklemeler tamamlandƒ±ƒüƒ±nda g√∂ster) -->
  <div
    class="bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg shadow-lg border border-blue-200 dark:border-blue-800 p-6"
  >
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center space-x-3">
        <div
          class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-lg"
        >
          <i class="fas fa-tasks text-white text-xl"></i>
        </div>
        <div>
          <h3 class="text-lg font-bold text-blue-900 dark:text-blue-100">
            Kat Sorumlusu G√∂revleri
          </h3>
          <p class="text-sm text-blue-700 dark:text-blue-300">
            {{ now().strftime('%d.%m.%Y') }} - Oda Kontrolleri
          </p>
        </div>
      </div>
      <div class="flex items-center gap-3">
        <span
          class="text-2xl font-bold {% if oda_kontrol_ozeti.tamamlanma_orani == 100 %}text-green-600{% elif oda_kontrol_ozeti.tamamlanma_orani >= 50 %}text-blue-600{% else %}text-yellow-600{% endif %}"
        >
          %{{ oda_kontrol_ozeti.tamamlanma_orani }}
        </span>
        <a
          href="{{ url_for('gorev.depo_personel_gorevler') }}"
          class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium text-sm"
        >
          <i class="fas fa-users mr-2"></i>Detay
        </a>
      </div>
    </div>

    <!-- ƒ∞lerleme √áubuƒüu -->
    <div class="mb-4">
      <div class="w-full bg-blue-100 dark:bg-blue-900/50 rounded-full h-3">
        <div
          class="bg-gradient-to-r from-blue-500 to-indigo-500 h-3 rounded-full transition-all duration-500"
          style="width: {{ oda_kontrol_ozeti.tamamlanma_orani }}%"
        ></div>
      </div>
    </div>

    <!-- G√∂rev Tipleri -->
    <div class="grid grid-cols-3 gap-4 mb-4">
      <div
        class="bg-white dark:bg-slate-800 rounded-lg p-4 border border-blue-200 dark:border-blue-700 text-center"
      >
        <div class="text-2xl font-bold text-blue-600 dark:text-blue-400">
          {{ oda_kontrol_ozeti.inhouse.tamamlanan }}/{{
          oda_kontrol_ozeti.inhouse.toplam }}
        </div>
        <div class="text-sm text-slate-600 dark:text-slate-400">In House</div>
        <div
          class="mt-1 w-full bg-blue-100 dark:bg-blue-900/50 rounded-full h-1"
        >
          <div
            class="bg-blue-500 h-1 rounded-full"
            style="width: {% if oda_kontrol_ozeti.inhouse.toplam > 0 %}{{ (oda_kontrol_ozeti.inhouse.tamamlanan / oda_kontrol_ozeti.inhouse.toplam * 100)|int }}{% else %}0{% endif %}%"
          ></div>
        </div>
      </div>
      <div
        class="bg-white dark:bg-slate-800 rounded-lg p-4 border border-purple-200 dark:border-purple-700 text-center"
      >
        <div class="text-2xl font-bold text-purple-600 dark:text-purple-400">
          {{ oda_kontrol_ozeti.arrival.tamamlanan }}/{{
          oda_kontrol_ozeti.arrival.toplam }}
        </div>
        <div class="text-sm text-slate-600 dark:text-slate-400">Arrivals</div>
        <div
          class="mt-1 w-full bg-purple-100 dark:bg-purple-900/50 rounded-full h-1"
        >
          <div
            class="bg-purple-500 h-1 rounded-full"
            style="width: {% if oda_kontrol_ozeti.arrival.toplam > 0 %}{{ (oda_kontrol_ozeti.arrival.tamamlanan / oda_kontrol_ozeti.arrival.toplam * 100)|int }}{% else %}0{% endif %}%"
          ></div>
        </div>
      </div>
      <div
        class="bg-white dark:bg-slate-800 rounded-lg p-4 border border-orange-200 dark:border-orange-700 text-center"
      >
        <div class="text-2xl font-bold text-orange-600 dark:text-orange-400">
          {{ oda_kontrol_ozeti.departure.tamamlanan }}/{{
          oda_kontrol_ozeti.departure.toplam }}
        </div>
        <div class="text-sm text-slate-600 dark:text-slate-400">Departures</div>
        <div
          class="mt-1 w-full bg-orange-100 dark:bg-orange-900/50 rounded-full h-1"
        >
          <div
            class="bg-orange-500 h-1 rounded-full"
            style="width: {% if oda_kontrol_ozeti.departure.toplam > 0 %}{{ (oda_kontrol_ozeti.departure.tamamlanan / oda_kontrol_ozeti.departure.toplam * 100)|int }}{% else %}0{% endif %}%"
          ></div>
        </div>
      </div>
    </div>

    <!-- √ñzet Bilgiler -->
    <div
      class="flex items-center justify-between text-sm bg-white dark:bg-slate-800 rounded-lg p-3 border border-blue-200 dark:border-blue-700"
    >
      <span class="flex items-center"
        ><i class="fas fa-check-circle text-green-500 mr-2"></i
        ><strong class="mr-1">{{ oda_kontrol_ozeti.tamamlanan }}</strong>
        Tamamlandƒ±</span
      >
      <span class="flex items-center"
        ><i class="fas fa-spinner text-blue-500 mr-2"></i
        ><strong class="mr-1">{{ oda_kontrol_ozeti.devam_eden }}</strong> Devam
        Ediyor</span
      >
      <span class="flex items-center"
        ><i class="fas fa-clock text-yellow-500 mr-2"></i
        ><strong class="mr-1">{{ oda_kontrol_ozeti.bekleyen }}</strong>
        Bekliyor</span
      >
    </div>
  </div>
  {% else %}
  <!-- G√ºnl√ºk Doluluk Y√ºklemeleri Widget (Y√ºklemeler tamamlanmadƒ±ƒüƒ±nda g√∂ster) -->
  <div
    class="bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 rounded-lg shadow-lg border border-emerald-200 dark:border-emerald-800 p-6"
  >
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center space-x-3">
        <div
          class="w-12 h-12 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-lg flex items-center justify-center shadow-lg"
        >
          <i class="fas fa-cloud-upload-alt text-white text-xl"></i>
        </div>
        <div>
          <h3 class="text-lg font-bold text-emerald-900 dark:text-emerald-100">
            G√ºnl√ºk Doluluk Y√ºklemeleri
          </h3>
          <p class="text-sm text-emerald-700 dark:text-emerald-300">
            {{ now().strftime('%d.%m.%Y') }}
          </p>
        </div>
      </div>
      <a
        href="{{ url_for('doluluk.doluluk_yonetimi') }}"
        class="px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium text-sm"
      >
        <i class="fas fa-upload mr-2"></i>Y√ºkleme Yap
      </a>
    </div>

    <!-- ƒ∞lerleme √áubuƒüu -->
    <div class="mb-4">
      <div class="flex items-center justify-between mb-2">
        <span class="text-sm font-medium text-emerald-700 dark:text-emerald-300"
          >ƒ∞lerleme</span
        >
        <span class="text-sm font-bold text-emerald-600 dark:text-emerald-400"
          >%{{ yukleme.tamamlanma_orani }}</span
        >
      </div>
      <div
        class="w-full bg-emerald-100 dark:bg-emerald-900/50 rounded-full h-3"
      >
        <div
          class="bg-gradient-to-r from-emerald-500 to-teal-500 h-3 rounded-full"
          style="width: {{ yukleme.tamamlanma_orani }}%"
        ></div>
      </div>
    </div>

    <!-- Y√ºkleme Durumlarƒ± -->
    <div class="grid grid-cols-3 gap-4">
      <!-- In House -->
      <div
        class="bg-white dark:bg-slate-800 rounded-lg p-4 border {% if yukleme.inhouse_durum == 'completed' %}border-green-300 dark:border-green-700{% else %}border-yellow-300 dark:border-yellow-700{% endif %}"
      >
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm font-medium text-slate-700 dark:text-slate-300"
            >In House</span
          >
          {% if yukleme.inhouse_durum == 'completed' %}
          <span
            class="px-2 py-1 text-xs font-bold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"
          >
            <i class="fas fa-check mr-1"></i>Y√ºklendi
          </span>
          {% else %}
          <span
            class="px-2 py-1 text-xs font-bold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400 animate-pulse"
          >
            <i class="fas fa-clock mr-1"></i>Bekliyor
          </span>
          {% endif %}
        </div>
        <p class="text-xs text-slate-500 dark:text-slate-400">
          Mevcut misafir listesi
        </p>
      </div>

      <!-- Arrivals -->
      <div
        class="bg-white dark:bg-slate-800 rounded-lg p-4 border {% if yukleme.arrivals_durum == 'completed' %}border-green-300 dark:border-green-700{% else %}border-yellow-300 dark:border-yellow-700{% endif %}"
      >
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm font-medium text-slate-700 dark:text-slate-300"
            >Arrivals</span
          >
          {% if yukleme.arrivals_durum == 'completed' %}
          <span
            class="px-2 py-1 text-xs font-bold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"
          >
            <i class="fas fa-check mr-1"></i>Y√ºklendi
          </span>
          {% else %}
          <span
            class="px-2 py-1 text-xs font-bold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400 animate-pulse"
          >
            <i class="fas fa-clock mr-1"></i>Bekliyor
          </span>
          {% endif %}
        </div>
        <p class="text-xs text-slate-500 dark:text-slate-400">
          Bug√ºn gelecek misafirler
        </p>
      </div>

      <!-- Departures -->
      <div
        class="bg-white dark:bg-slate-800 rounded-lg p-4 border {% if yukleme.departures_durum == 'completed' %}border-green-300 dark:border-green-700{% else %}border-yellow-300 dark:border-yellow-700{% endif %}"
      >
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm font-medium text-slate-700 dark:text-slate-300"
            >Departures</span
          >
          {% if yukleme.departures_durum == 'completed' %}
          <span
            class="px-2 py-1 text-xs font-bold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"
          >
            <i class="fas fa-check mr-1"></i>Y√ºklendi
          </span>
          {% else %}
          <span
            class="px-2 py-1 text-xs font-bold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400 animate-pulse"
          >
            <i class="fas fa-clock mr-1"></i>Bekliyor
          </span>
          {% endif %}
        </div>
        <p class="text-xs text-slate-500 dark:text-slate-400">
          Bug√ºn √ßƒ±kƒ±≈ü yapacaklar
        </p>
      </div>
    </div>

    {% if yukleme.bekleyen > 0 %}
    <div
      class="mt-4 p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg border border-yellow-300 dark:border-yellow-700"
    >
      <div class="flex items-center">
        <i
          class="fas fa-exclamation-triangle text-yellow-600 dark:text-yellow-400 mr-2"
        ></i>
        <span class="text-sm text-yellow-800 dark:text-yellow-200">
          <strong>{{ yukleme.bekleyen }}</strong> dosya y√ºklenmedi! Saat 10:00'a
          kadar y√ºkleyiniz.
        </span>
      </div>
    </div>
    {% endif %}
  </div>
  {% endif %}

  <!-- Bekleyen Kat Sorumlusu Sipari≈üleri Widget -->
  <div
    id="bekleyen_siparisler_widget"
    class="hidden bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg shadow-lg border-2 border-blue-300 dark:border-blue-700 p-4 md:p-6"
  >
    <div class="flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <div
          class="w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center animate-pulse"
        >
          <i class="fas fa-shopping-cart text-white text-xl"></i>
        </div>
        <div>
          <h3 class="text-lg font-bold text-blue-900 dark:text-blue-100">
            <span id="bekleyen_siparis_sayisi">0</span> Bekleyen Sipari≈ü
          </h3>
          <p class="text-sm text-blue-700 dark:text-blue-300">
            Kat sorumlularƒ±ndan gelen talepler
          </p>
        </div>
      </div>
      <a
        href="{{ url_for('kat_sorumlusu_siparisler') }}"
        class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium"
      >
        <i class="fas fa-arrow-right mr-2"></i>Sipari≈üleri G√∂r
      </a>
    </div>
  </div>

  <!-- Otel Doluluk Bilgileri -->
  {% if otel_doluluk_bilgileri %} {% set otel_sayisi =
  otel_doluluk_bilgileri|length %}
  <div
    class="grid grid-cols-1 gap-4 {% if otel_sayisi == 1 %}{% elif otel_sayisi == 2 %}sm:grid-cols-2{% else %}sm:grid-cols-2 lg:grid-cols-3{% endif %}"
  >
    {% for otel in otel_doluluk_bilgileri %}
    <a
      href="{{ url_for('doluluk.gunluk_doluluk') }}?otel_id={{ otel.otel_id }}"
      class="block bg-white dark:bg-slate-800 rounded-lg shadow-md overflow-hidden cursor-pointer"
    >
      <!-- Otel Ba≈ülƒ±k -->
      <div
        class="bg-slate-100 dark:bg-slate-700 px-4 py-3 flex items-center justify-between border-b border-slate-200 dark:border-slate-600"
      >
        <div class="flex items-center space-x-3">
          {% if otel.otel_logo %}
          <div
            class="h-10 w-10 rounded-lg bg-white dark:bg-slate-600 flex items-center justify-center shadow-sm overflow-hidden p-1"
          >
            <img
              src="data:image/png;base64,{{ otel.otel_logo }}"
              alt="{{ otel.otel_ad }}"
              class="max-h-full max-w-full object-contain"
              onerror="this.parentElement.innerHTML='<svg class=\'w-6 h-6 text-slate-700 dark:text-slate-300\' fill=\'currentColor\' viewBox=\'0 0 20 20\'><path d=\'M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z\'></path></svg>';"
            />
          </div>
          {% else %}
          <div
            class="h-10 w-10 rounded-lg bg-white dark:bg-slate-600 flex items-center justify-center shadow-sm"
          >
            <svg
              class="w-6 h-6 text-slate-700 dark:text-slate-300"
              fill="currentColor"
              viewBox="0 0 20 20"
            >
              <path
                d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"
              ></path>
            </svg>
          </div>
          {% endif %}
          <h4 class="text-slate-900 dark:text-slate-100 font-semibold">
            {{ otel.otel_ad }}
          </h4>
        </div>
        <span
          class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-bold {% if otel.doluluk_orani >= 80 %}bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200 {% elif otel.doluluk_orani >= 50 %}bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 {% else %}bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200{% endif %}"
        >
          %{{ otel.doluluk_orani }}
        </span>
      </div>

      <!-- Doluluk Detaylarƒ± -->
      <div class="p-4 space-y-3">
        <!-- Progress Bar -->
        <div>
          <div
            class="flex justify-between text-xs text-slate-600 dark:text-slate-400 mb-1"
          >
            <span>Doluluk Oranƒ±</span>
            <span class="font-semibold"
              >{{ otel.dolu_oda }}/{{ otel.toplam_oda }}</span
            >
          </div>
          <div
            class="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-3 overflow-hidden"
          >
            <div
              class="h-3 rounded-full {% if otel.doluluk_orani >= 80 %}bg-gradient-to-r from-red-500 to-red-600 {% elif otel.doluluk_orani >= 50 %}bg-gradient-to-r from-yellow-500 to-yellow-600 {% else %}bg-gradient-to-r from-green-500 to-green-600{% endif %}"
              style="width: {{ otel.doluluk_orani }}%"
            ></div>
          </div>
        </div>

        <!-- ƒ∞statistikler -->
        <div
          class="grid grid-cols-3 gap-2 pt-2 border-t border-slate-200 dark:border-slate-700"
        >
          <div class="text-center">
            <div class="text-xs text-slate-500 dark:text-slate-400 mb-1">
              Toplam
            </div>
            <div class="text-lg font-bold text-slate-900 dark:text-slate-100">
              {{ otel.toplam_oda }}
            </div>
          </div>
          <div
            class="text-center border-l border-r border-slate-200 dark:border-slate-700"
          >
            <div class="text-xs text-slate-500 dark:text-slate-400 mb-1">
              Dolu
            </div>
            <div class="text-lg font-bold text-blue-600 dark:text-blue-400">
              {{ otel.dolu_oda }}
            </div>
          </div>
          <div class="text-center">
            <div class="text-xs text-slate-500 dark:text-slate-400 mb-1">
              Bo≈ü
            </div>
            <div class="text-lg font-bold text-green-600 dark:text-green-400">
              {{ otel.bos_oda }}
            </div>
          </div>
        </div>
      </div>
    </a>
    {% endfor %}
  </div>
  {% endif %}

  <!-- ƒ∞statistik Kartlarƒ± -->
  <div class="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4">
    <div class="bg-white overflow-hidden shadow rounded-lg">
      <div class="p-5">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <div
              class="w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center"
            >
              <svg
                class="w-5 h-5 text-white"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"
                ></path>
              </svg>
            </div>
          </div>
          <div class="ml-5 w-0 flex-1">
            <dl>
              <dt class="text-sm font-medium text-slate-500 truncate">
                Toplam √úr√ºn
              </dt>
              <dd class="text-lg font-medium text-slate-900">
                {{ toplam_urun }}
              </dd>
            </dl>
          </div>
        </div>
      </div>
    </div>

    <div class="bg-white overflow-hidden shadow rounded-lg">
      <div class="p-5">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <div
              class="w-8 h-8 bg-red-500 rounded-md flex items-center justify-center"
            >
              <svg
                class="w-5 h-5 text-white"
                fill="currentColor"
                viewBox="0 0 20 20"
              >
                <path
                  fill-rule="evenodd"
                  d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"
                  clip-rule="evenodd"
                ></path>
              </svg>
            </div>
          </div>
          <div class="ml-5 w-0 flex-1">
            <dl>
              <dt class="text-sm font-medium text-slate-500 truncate">
                Kritik Stok
              </dt>
              <dd class="text-lg font-medium text-slate-900">
                {{ kritik_urunler|length }}
              </dd>
            </dl>
          </div>
        </div>
      </div>
    </div>

    <div class="bg-white overflow-hidden shadow rounded-lg">
      <div class="p-5">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <div
              class="w-8 h-8 bg-green-500 rounded-md flex items-center justify-center"
            >
              <svg
                class="w-5 h-5 text-white"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                ></path>
              </svg>
            </div>
          </div>
          <div class="ml-5 w-0 flex-1">
            <dl>
              <dt class="text-sm font-medium text-slate-500 truncate">
                Aktif Zimmetler
              </dt>
              <dd class="text-lg font-medium text-slate-900">
                {{ aktif_zimmetler }}
              </dd>
            </dl>
          </div>
        </div>
      </div>
    </div>

    <div class="bg-white overflow-hidden shadow rounded-lg">
      <div class="p-5">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <div
              class="w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center"
            >
              <svg
                class="w-5 h-5 text-white"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"
                ></path>
              </svg>
            </div>
          </div>
          <div class="ml-5 w-0 flex-1">
            <dl>
              <dt class="text-sm font-medium text-slate-500 truncate">
                Bu Ay ƒ∞adeler
              </dt>
              <dd class="text-lg font-medium text-slate-900">
                {{ bu_ay_iadeler }}
              </dd>
            </dl>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Hƒ±zlƒ± ƒ∞≈ülemler -->
  <div class="bg-white shadow rounded-lg">
    <div class="px-4 py-5 sm:p-6">
      <h3 class="text-lg leading-6 font-medium text-slate-900 mb-4">
        Hƒ±zlƒ± ƒ∞≈ülemler
      </h3>
      <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4">
        <a
          href="{{ url_for('ana_depo_tedarik') }}"
          class="relative bg-gradient-to-br from-emerald-50 to-teal-50 p-6 rounded-lg border-2 border-emerald-200"
        >
          <div>
            <span
              class="rounded-lg inline-flex p-3 bg-emerald-100 text-emerald-700 ring-4 ring-white"
            >
              <svg
                class="h-6 w-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"
                ></path>
              </svg>
            </span>
          </div>
          <div class="mt-4">
            <h3 class="text-lg font-medium text-emerald-900">
              <span class="absolute inset-0" aria-hidden="true"></span>
              Ana Depo Tedarik
            </h3>
            <p class="mt-2 text-sm text-emerald-700">Ana depodan √ºr√ºn √ßek</p>
          </div>
        </a>

        <a
          href="{{ url_for('siparis_listesi') }}"
          class="relative bg-white p-6 rounded-lg border border-slate-200"
        >
          <div>
            <span
              class="rounded-lg inline-flex p-3 bg-purple-50 text-purple-700 ring-4 ring-white"
            >
              <svg
                class="h-6 w-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"
                ></path>
              </svg>
            </span>
          </div>
          <div class="mt-4">
            <h3 class="text-lg font-medium">
              <span class="absolute inset-0" aria-hidden="true"></span>
              Sipari≈ü Listesi
            </h3>
            <p class="mt-2 text-sm text-slate-500">
              Sipari≈üleri g√∂r√ºnt√ºle ve yeni sipari≈ü olu≈ütur
            </p>
          </div>
        </a>

        <a
          href="{{ url_for('personel_zimmet') }}"
          class="relative bg-white p-6 rounded-lg border border-slate-200"
        >
          <div>
            <span
              class="rounded-lg inline-flex p-3 bg-green-50 text-green-700 ring-4 ring-white"
            >
              <svg
                class="h-6 w-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                ></path>
              </svg>
            </span>
          </div>
          <div class="mt-4">
            <h3 class="text-lg font-medium">
              <span class="absolute inset-0" aria-hidden="true"></span>
              Personel Zimmet
            </h3>
            <p class="mt-2 text-sm text-slate-500">
              Kat sorumlusuna zimmet atayƒ±n
            </p>
          </div>
        </a>

        <a
          href="{{ url_for('depo_raporlar') }}"
          class="relative bg-white p-6 rounded-lg border border-slate-200"
        >
          <div>
            <span
              class="rounded-lg inline-flex p-3 bg-yellow-50 text-yellow-700 ring-4 ring-white"
            >
              <svg
                class="h-6 w-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                ></path>
              </svg>
            </span>
          </div>
          <div class="mt-4">
            <h3 class="text-lg font-medium">
              <span class="absolute inset-0" aria-hidden="true"></span>
              Raporlar
            </h3>
            <p class="mt-2 text-sm text-slate-500">Stok ve zimmet raporlarƒ±</p>
          </div>
        </a>
      </div>
    </div>
  </div>

  <!-- Geli≈ümi≈ü Stok Uyarƒ±larƒ± - Kategorize Edilmi≈ü -->
  <div class="bg-white shadow rounded-lg">
    <div class="px-4 py-5 sm:p-6">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-lg leading-6 font-medium text-slate-900">
          üìä Stok Durumu ƒ∞statistikleri
        </h3>
        <div class="flex space-x-4 text-sm">
          <div class="flex items-center">
            <span
              class="inline-block w-3 h-3 bg-red-500 rounded-full mr-2"
            ></span>
            <span class="text-slate-600"
              >Kritik:
              <strong>{{ stok_durumlari.istatistik.kritik_sayi }}</strong></span
            >
          </div>
          <div class="flex items-center">
            <span
              class="inline-block w-3 h-3 bg-yellow-500 rounded-full mr-2"
            ></span>
            <span class="text-slate-600"
              >Dikkat:
              <strong>{{ stok_durumlari.istatistik.dikkat_sayi }}</strong></span
            >
          </div>
          <div class="flex items-center">
            <span
              class="inline-block w-3 h-3 bg-green-500 rounded-full mr-2"
            ></span>
            <span class="text-slate-600"
              >Normal:
              <strong>{{ stok_durumlari.istatistik.normal_sayi }}</strong></span
            >
          </div>
        </div>
      </div>

      <!-- Kritik Stok Uyarƒ±larƒ± -->
      {% if stok_durumlari.kritik %}
      <div class="mb-6">
        <h4 class="text-md font-medium text-red-700 mb-3 flex items-center">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path
              fill-rule="evenodd"
              d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"
              clip-rule="evenodd"
            />
          </svg>
          Kritik Stok Uyarƒ±larƒ± ({{ stok_durumlari.kritik|length }})
        </h4>
        <div class="grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3">
          {% for item in stok_durumlari.kritik %}
          <div class="bg-red-50 border-2 border-red-300 rounded-lg p-4">
            <div class="flex items-start justify-between">
              <div class="flex-1">
                <div class="flex items-center mb-2">
                  <span
                    class="inline-flex px-2.5 py-1 text-xs font-bold rounded-full {{ item.badge_class }}"
                  >
                    {{ item.badge_text }}
                  </span>
                </div>
                <h5 class="text-sm font-semibold text-slate-900 mb-1">
                  {{ item.urun.urun_adi }}
                </h5>
                <p class="text-xs text-slate-600">
                  Grup: {{ item.urun.grup.grup_adi }}
                </p>
                <div class="mt-3 space-y-1">
                  <div class="flex justify-between text-xs">
                    <span class="text-slate-500">Mevcut Stok:</span>
                    <span class="font-bold text-red-700"
                      >{{ item.mevcut_stok }} {{ item.urun.birim }}</span
                    >
                  </div>
                  <div class="flex justify-between text-xs">
                    <span class="text-slate-500">Kritik Seviye:</span>
                    <span class="font-medium text-slate-700"
                      >{{ item.kritik_seviye }} {{ item.urun.birim }}</span
                    >
                  </div>
                  <!-- Progress bar -->
                  <div class="mt-2">
                    <div class="w-full bg-red-200 rounded-full h-2">
                      <div
                        class="bg-red-600 h-2 rounded-full"
                        style="width: {{ [item.yuzde, 100]|min }}%"
                      ></div>
                    </div>
                    <span class="text-xs text-slate-500 mt-1 block"
                      >%{{ "%.0f"|format(item.yuzde) }}</span
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- Dikkat Gerektiren √úr√ºnler -->
      {% if stok_durumlari.dikkat %}
      <div class="mb-6">
        <h4 class="text-md font-medium text-yellow-700 mb-3 flex items-center">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path
              fill-rule="evenodd"
              d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
              clip-rule="evenodd"
            />
          </svg>
          Dikkat Gerektiren √úr√ºnler ({{ stok_durumlari.dikkat|length }})
        </h4>
        <div class="grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-4">
          {% for item in stok_durumlari.dikkat %}
          <div class="bg-yellow-50 border border-yellow-300 rounded-lg p-3">
            <div class="flex items-center mb-2">
              <span
                class="inline-flex px-2 py-0.5 text-xs font-semibold rounded-full {{ item.badge_class }}"
              >
                {{ item.badge_text }}
              </span>
            </div>
            <h5 class="text-sm font-semibold text-slate-900 mb-1">
              {{ item.urun.urun_adi }}
            </h5>
            <div class="flex justify-between text-xs text-slate-600 mt-2">
              <span>Mevcut:</span>
              <span class="font-bold text-yellow-700"
                >{{ item.mevcut_stok }}</span
              >
            </div>
            <div class="mt-1">
              <div class="w-full bg-yellow-200 rounded-full h-1.5">
                <div
                  class="bg-yellow-500 h-1.5 rounded-full"
                  style="width: {{ [item.yuzde, 100]|min }}%"
                ></div>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- Yeterli Stok - √ñzet -->
      {% if stok_durumlari.normal %}
      <div>
        <h4 class="text-md font-medium text-green-700 mb-2 flex items-center">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path
              fill-rule="evenodd"
              d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
              clip-rule="evenodd"
            />
          </svg>
          Yeterli Stokta ({{ stok_durumlari.normal|length }})
        </h4>
        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
          <p class="text-sm text-green-800">
            <strong>{{ stok_durumlari.normal|length }}</strong> √ºr√ºn normal stok
            seviyesindedir.
            <span class="text-green-600">‚úì Stok y√∂netimi iyi durumda.</span>
          </p>
        </div>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- √úr√ºn Bazlƒ± T√ºketim Grafiƒüi -->
  <div class="bg-white shadow rounded-lg">
    <div class="px-4 py-5 sm:p-6">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg leading-6 font-medium text-slate-900">
          üìà √úr√ºn Bazlƒ± T√ºketim (Son 30 G√ºn)
        </h3>
        <span class="text-xs text-slate-500">En √ßok t√ºketilen 10 √ºr√ºn</span>
      </div>
      {% if urun_labels %}
      <div class="h-80">
        <canvas id="urunTuketimChart"></canvas>
      </div>
      {% else %}
      <div class="text-center py-12">
        <svg
          class="mx-auto h-12 w-12 text-slate-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
          ></path>
        </svg>
        <p class="mt-2 text-sm text-slate-500">
          Son 30 g√ºnde t√ºketim verisi bulunmuyor
        </p>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- Son Stok Hareketleri -->
  <div class="bg-white shadow rounded-lg">
    <div class="px-4 py-5 sm:p-6">
      <h3 class="text-lg leading-6 font-medium text-slate-900 mb-4">
        Son Stok Hareketleri
      </h3>
      {% if son_hareketler %}
      <div class="overflow-hidden">
        <table
          id="son-stok-hareketler-table"
          class="min-w-full divide-y divide-slate-200"
        >
          <thead class="bg-slate-50">
            <tr>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"
              >
                √úr√ºn
                <span
                  class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800"
                >
                  {{ son_hareketler|length }} hareket
                </span>
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"
              >
                Hareket Tipi
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider"
              >
                Miktar
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider hidden lg:table-cell"
              >
                Tarih
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider hidden md:table-cell"
              >
                ƒ∞≈ülem Yapan
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider hidden xl:table-cell"
              >
                ƒ∞≈ülemler
              </th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-slate-200">
            {% for hareket in son_hareketler %}
            <tr>
              <td
                class="px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900"
              >
                üì¶ {{ hareket.urun.urun_adi }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span
                  class="inline-flex items-center px-2.5 py-1 text-xs font-semibold rounded-full {% if hareket.hareket_tipi == 'giris' %}bg-green-100 text-green-800 {% elif hareket.hareket_tipi == 'cikis' %}bg-red-100 text-red-800 {% elif hareket.hareket_tipi == 'devir' %}bg-blue-100 text-blue-800 {% else %}bg-gray-100 text-gray-800{% endif %}"
                >
                  {% if hareket.hareket_tipi == 'giris' %}üü¢{% elif
                  hareket.hareket_tipi == 'cikis' %}üî¥{% elif
                  hareket.hareket_tipi == 'devir' %}üîµ{% else %}üü°{% endif %} {{
                  hareket.hareket_tipi.title() }}
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm">
                <span
                  class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"
                >
                  {{ hareket.miktar }}
                </span>
              </td>
              <td
                class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 hidden lg:table-cell"
              >
                üìÖ {{ hareket.islem_tarihi.strftime('%d.%m.%Y %H:%M') }}
              </td>
              <td
                class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 hidden md:table-cell"
              >
                {% if hareket.islem_yapan %} üë§ {{ hareket.islem_yapan.ad }} {{
                hareket.islem_yapan.soyad }} {% else %} - {% endif %}
              </td>
              <td
                class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 hidden xl:table-cell"
              >
                <a
                  href="{{ url_for('stok_duzenle', hareket_id=hareket.id) }}"
                  class="text-blue-600 font-medium"
                >
                  ‚úèÔ∏è D√ºzenle
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <p class="text-slate-500 text-center py-4">
        Hen√ºz stok hareketi bulunmuyor.
      </p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %} {% block extra_scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script>
  // Bekleyen sipari≈üleri y√ºkle
  async function bekleyenSiparisleriYukle() {
    try {
      const response = await fetch('/api/depo/bekleyen-siparisler');
      const data = await response.json();

      if (data.success && data.siparisler && data.siparisler.length > 0) {
        document.getElementById('bekleyen_siparis_sayisi').textContent = data.siparisler.length;
        document.getElementById('bekleyen_siparisler_widget').classList.remove('hidden');
      }
    } catch (error) {
      console.error('‚ùå Bekleyen sipari≈üler y√ºklenemedi:', error);
    }
  }

  // Sayfa y√ºklendiƒüinde ve her 30 saniyede bir kontrol et
  document.addEventListener('DOMContentLoaded', function () {
    bekleyenSiparisleriYukle();
    setInterval(bekleyenSiparisleriYukle, 30000); // 30 saniye
  });

  // √úr√ºn Bazlƒ± T√ºketim Grafiƒüi
  {% if urun_labels %}
  const urunTuketimCtx = document.getElementById('urunTuketimChart');
  if (urunTuketimCtx) {
    // Gradient olu≈ütur
    const gradient = urunTuketimCtx.getContext('2d').createLinearGradient(0, 0, 0, 400);
    gradient.addColorStop(0, 'rgba(59, 130, 246, 0.8)');
    gradient.addColorStop(0.5, 'rgba(99, 102, 241, 0.6)');
    gradient.addColorStop(1, 'rgba(139, 92, 246, 0.4)');

    new Chart(urunTuketimCtx, {
      type: 'bar',
      data: {
        labels: {{ urun_labels | tojson }},
  datasets: [{
    label: 'T√ºketim Miktarƒ±',
    data: {{ urun_tuketim_miktarlari | tojson }},
    backgroundColor: gradient,
    borderColor: 'rgba(99, 102, 241, 1)',
    borderWidth: 2,
    borderRadius: 8,
    borderSkipped: false,
              }]
          },
  options: {
    responsive: true,
      maintainAspectRatio: false,
        plugins: {
      legend: {
        display: false
      },
      title: {
        display: false
      },
      tooltip: {
        backgroundColor: 'rgba(0, 0, 0, 0.8)',
          padding: 12,
            titleFont: {
          size: 14,
            weight: 'bold'
        },
        bodyFont: {
          size: 13
        },
        callbacks: {
          label: function(context) {
            return ' T√ºketim: ' + context.parsed.y + ' adet';
          }
        }
      }
    },
    scales: {
      y: {
        beginAtZero: true,
          grid: {
          color: 'rgba(0, 0, 0, 0.05)',
            drawBorder: false
        },
        ticks: {
          font: {
            size: 11
          },
          color: '#64748b',
            precision: 0
        }
      },
      x: {
        grid: {
          display: false
        },
        ticks: {
          font: {
            size: 11
          },
          color: '#64748b',
            maxRotation: 45,
              minRotation: 45
        }
      }
    },
    animation: {
      duration: 1000,
        easing: 'easeInOutQuart'
    }
  }
      });
  }
  {% endif %}

  // TableSearchFilter - Son Stok Hareketleri
  {% if son_hareketler %}
  document.addEventListener('DOMContentLoaded', function () {
    const stokHareketlerTable = document.getElementById('son-stok-hareketler-table');
    if (stokHareketlerTable && typeof TableSearchFilter !== 'undefined') {
      new TableSearchFilter('son-stok-hareketler-table', {
        searchPlaceholder: 'Stok hareketlerinde ara (√ºr√ºn, i≈ülem yapan)...',
        defaultItemsPerPage: 10
      });
    }
  });
  {% endif %}
</script>
{% endblock %}
